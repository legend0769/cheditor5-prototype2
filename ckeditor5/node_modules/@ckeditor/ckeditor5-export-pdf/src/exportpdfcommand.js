/*
 *             Copyright (c) 2016 - 2022, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
import{Command as _0x214dbe}from'ckeditor5/src/core';import{getStyles as _0x3a04c5}from'./utils';export default class o extends _0x214dbe{constructor(_0x90738f){super(_0x90738f),this['set']('isBusy',!0x1),this['affectsData']=!0x1;}['refresh'](){this['isEnabled']=!this['isBusy'],this['value']=this['isBusy']?'pending':void 0x0;}['execute'](_0x1acfd2={}){const _0x280d94=this['editor'],t=_0x280d94['t'],_0x36d172=_0x1acfd2['converterUrl']||'https://pdf-converter.cke-cs.com/v1/convert/',_0x24caa7=_0x1acfd2['dataCallback']||(_0x4137d8=>_0x4137d8['getData']()),_0x2d6198=_0x280d94['plugins']['get']('ExportPdf'),_0x4d8c14=_0x1acfd2['token']||_0x2d6198['_token'];return this['isBusy']=!0x0,this['refresh'](),_0x3a04c5(_0x1acfd2['stylesheets']||['EDITOR_STYLES'])['then'](_0x429e3b=>{const _0x54ac02={'html':'<html>\x0a\x09\x09\x09\x09\x09\x09<head>\x0a\x09\x09\x09\x09\x09\x09\x09<meta\x20charset=\x22utf-8\x22>\x0a\x09\x09\x09\x09\x09\x09</head>\x0a\x09\x09\x09\x09\x09\x09<body>\x0a\x09\x09\x09\x09\x09\x09\x09<div\x20class=\x22ck-content\x22\x20dir=\x22'+_0x280d94['locale']['contentLanguageDirection']+'\x22>\x0a\x09\x09\x09\x09\x09\x09\x09\x09'+_0x24caa7(_0x280d94)+'\x0a\x09\x09\x09\x09\x09\x09\x09</div>\x0a\x09\x09\x09\x09\x09\x09<body>\x0a\x09\x09\x09\x09\x09</html>','css':_0x429e3b,'options':_0x1acfd2['converterOptions']},_0x1debd1={'method':'POST','headers':{'Content-Type':'application/json','Accept':'application/pdf',..._0x4d8c14?{'Authorization':_0x4d8c14['value']}:null,'x-cs-app-id':_0x1acfd2['appID']||'cke5'},'body':JSON['stringify'](_0x54ac02)};return window['fetch'](_0x36d172,_0x1debd1)['then'](_0x2887ef=>{if(0xc8!==_0x2887ef['status'])throw _0x2887ef;return _0x2887ef['blob']();})['then'](_0x4463c4=>{this['o'](_0x4463c4,_0x1acfd2['fileName']||'document.pdf');});})['catch'](_0x310a29=>{throw _0x280d94['plugins']['get']('Notification')['showWarning'](t('An\x20error\x20occurred\x20while\x20generating\x20the\x20PDF.')),_0x310a29;})['finally'](()=>{this['isBusy']=!0x1,this['refresh']();});}['o'](_0x5e9aee,_0x99e3fe){const _0x1f6f3f=document['createElement']('a');_0x1f6f3f['href']=window['URL']['createObjectURL'](_0x5e9aee),_0x1f6f3f['download']=_0x99e3fe,_0x1f6f3f['click'](),_0x1f6f3f['remove']();}}