/*
 *             Copyright (c) 2016 - 2022, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
import{Command as _0x143a02}from'ckeditor5/src/core';import{getStyles as _0x174ef0,getConverterOptions as _0x527c4c}from'./utils';export default class i extends _0x143a02{constructor(_0x1107c3){super(_0x1107c3),this['set']('isBusy',!0x1),this['affectsData']=!0x1;}['refresh'](){this['isEnabled']=!this['isBusy'],this['value']=this['isBusy']?'pending':void 0x0;}['execute'](_0x351873={}){const _0x296507=this['editor'],t=_0x296507['t'],_0x41296d=_0x351873['converterUrl']||'https://docx-converter.cke-cs.com/v1/convert',_0x452436=_0x351873['converterOptions']||{},_0x9299c9=_0x296507['plugins']['get']('ExportWord'),_0x469ad7=_0x351873['token']||_0x9299c9['_token'],_0x41c05b=!0x1!==_0x452436['auto_pagination'],_0x2f36fb=_0x351873['dataCallback']||(_0x19fa7b=>_0x19fa7b['getData']({'pagination':_0x41c05b}));return this['isBusy']=!0x0,this['refresh'](),_0x174ef0(_0x351873['stylesheets']||['EDITOR_STYLES'])['then'](_0x5d8123=>{const _0x331637=_0x2f36fb(_0x296507),_0x11f0a0={'html':'<div\x20class=\x22ck-content\x22\x20dir=\x22'+_0x296507['locale']['contentLanguageDirection']+'\x22>'+_0x331637+'</div>','css':_0x5d8123,'options':{..._0x452436,..._0x527c4c(_0x296507)}},_0x3d8b82={'method':'POST','headers':{'Content-Type':'application/json','Accept':'application/docx',..._0x469ad7?{'Authorization':_0x469ad7['value']}:null},'body':JSON['stringify'](_0x11f0a0)};return window['fetch'](_0x41296d,_0x3d8b82)['then'](_0x3eb1ad=>{if(0xc8!==_0x3eb1ad['status'])throw _0x3eb1ad;return _0x3eb1ad['blob']();})['then'](_0x38426d=>{this['o'](_0x38426d,_0x351873['fileName']||'document.docx');});})['catch'](_0x390d91=>{throw _0x296507['plugins']['get']('Notification')['showWarning'](t('An\x20error\x20occurred\x20while\x20generating\x20the\x20Word\x20file.')),_0x390d91;})['finally'](()=>{this['isBusy']=!0x1,this['refresh']();});}['o'](_0x23cd53,_0x14290b){const _0x35dee5=document['createElement']('a');_0x35dee5['href']=window['URL']['createObjectURL'](_0x23cd53),_0x35dee5['download']=_0x14290b,_0x35dee5['click'](),_0x35dee5['remove']();}}